\documentclass[a4paper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[hungarian]{babel}
\usepackage{graphicx}
\usepackage{geometry}
\geometry{a4paper,
		     tmargin = 30mm, 
		     lmargin = 30mm,
		     rmargin = 30mm,
		     bmargin = 30mm}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{color}
\usepackage{setspace}
\usepackage{amsmath,amssymb}
\usepackage{float}
\usepackage{indentfirst}
\usepackage{algorithm}
\usepackage{algorithmic}

\renewcommand\thesection{\Roman{section}}
\renewcommand\thesubsection{\thesection.\arabic{subsection}}

\begin{document}

\begin{titlepage}
% Template for future notes.

	\centering
	
	\includegraphics[width=0.66\textwidth]{elte.jpg}\par\vspace{1cm}
	{\scshape\LARGE ELTE TTK \par}
	{\scshape\large Fizika szak \par}
	\vspace{1cm}
	
	{\scshape\LARGE Szakdolgozat \par}
	\vspace{1cm}
	
	{\scshape\Large Koaleszcencia modell kidolgozása transzportmodellekhez\par}
	\vspace{0.2cm}
	{\Large\itshape Olar Alex\par}
	\vspace{2cm}
	
	témavezető\par
	\vspace{0.3cm}
	{\Large Wolf György}

	\vfill

	{\large 2018 \par}
\end{titlepage}

\begin{abstract}
\par Egy nehézion ütközésben résztvevő alkotó elemek száma néhány ezerig terjed legfeljebb, így a kidolgozott néhány-test elméletek, mint a három-test problémára kidolgozott Fagyejev-egyenletek, nem alkalmazhatóak, de az alkotóelemek alacsony száma miatt még a statisztikus fizikai modellek sem használhatóak, ráadásul nem is egyensúlyi reakciókról van szó az esetek többségében.
\par A rendelkezésre álló számítási kapacitás lehetővé tette, egy-egy ilyen nemegyensúlyi reakció teljes vizsgálatát, mikroszkópikus transzport-modellek segítségével. Egy ilyen modell a Boltzmann-Uehling-Uhlenbeck elmélet (BUU), ami fázistérben leírja adott részecskék között az ütközéseket és figyelembe veszi az azok között ható kölcsönhatást, egy időfüggő, átlagtér potenciállal. Korai modellek a részecskéket szabadnak tekintették, amikor azok nem vettek részt ütközésekben.
\par Az én célom, hogy egy, a BUU-ra épülő szimulációhoz kidolgozzak egy olyan programot, ami a kölcsönható részecskéket, esetemben főként nukleonokat, klaszterezi, azaz csomósodásokat keres különböző távolság definíciók mellett (térben, impulzustérben, stb.). Ennek fontos szerepe lehet a detektor válasz meghatározásakor, 
\end{abstract}

\vfill

\newpage
\tableofcontents
\newpage

\section{Elméleti áttekintés}

\subsection{Bevezető}

\par Egy nehézion ütközés erősen nem egyensúlyi termodinamikai rendszer. A statisztikus fizikában $10^{23}$ részecskére jól kidolgozott, statisztikus modell áll rendelkezésünkre, továbbá jól tudjuk magyarázni a néhányrészecske rendszereket is, azonban például egy $Au+Au$ ütközésben a részecskék száma még és már nem kezelhető a korábbi modellekkel.

\par Kezdetben a folyamat leírására termodinamikai modelleket állítottak fel, amelyekben különböző hipotéziseket tettek fel. Ezek közé tartozott, hogy a részecskék gyorsan termalizálódnak és kialakul egy globális egyensúly, és már egyensúlyi állapotukban detektáljuk őket. Eztután hidrodinamikai modellekhez folyamodtak amelyekben már nem volt globális, csak lokális termodinamikai egyensúly.

\par Azonban egy prominensebb ága a nehézion ütközések leírásának a nemegyensúlyi, mikroszkopikus transzport-modellek. Először kaszkád elméleteket dolgoztak ki, amelyben a részecskék között csak ütközéskor hatottak kölcsön, később azonban hosszú hatótávolságú erőket és nukleáris potenciálokat is figyelembe vettek.

\section{Transzport egyenletek}

\par A nehézion ütközések dinmaikáját transzport egyenletek segítségével lehet vizsgálni. Ennek két fő irányzata van, az egyik a Boltzmann-modellre épülő hidrodinamikai megközelítés, ami szerint 

\begin{equation}
	N = \int d^{3}\vec{p} \int d^{3}\vec{r} \quad f(\vec{r}, \vec{p}, t)
\end{equation}

ahol N a részecskék száma, míg $f(\vec{r}, \vec{p}, t)$ a fázistérben vett sűrűség függvény. Mivel a fázistérfogatelem ( $d^{3}\vec{p}\cdot d^{3}\vec{r}$ ) állandó, azonban ütközés során a részecske sűrűség változik, így az csak a fázissűrűségen keresztül változhat. Így tehát kapjuk a Boltzmann-egyenletet

\begin{equation}
	\frac{df}{dt} = \frac{\partial f}{\partial t} + \frac{\partial f}{\partial \vec{p}}\frac{d\vec{p}}{dt} + \frac{\partial f}{\partial \vec{r}}\frac{d\vec{r}}{dt} = I_{coll}
\end{equation}

\par Ezt pedig a szokott alakra hozva, bevezethetünk egy $I_{coll}$ ütközési integrált, amire különböző hipotéziseket tehetünk majd fel.

\begin{equation}
	\frac{\partial f}{\partial t} + \frac{\partial f}{\partial \vec{p}}\vec{F} + \vec{\nabla}f\frac{\vec{p}}{m} = I_{coll}
\end{equation}

\par Ez még természetesen csak az alapvető fizikai modell, a transzport-modellhez az úgynevezett Boltzmann-Uehling-Uhlenbeck egyenleteket használják. Tehát az előbbi egyenletbe bevezetnek egy impulzusfüggő átlagtéret $U(\vec{r}, \vec{p})$. Alacsony energiákon a rugalmatlan ütközések elhanyagolhatóak, a rendszer csak nukleonokból áll. 
	
\begin{gather}
	m^{*}(\vec{r}, \vec{p}) = m_{N} + U(\vec{r}, \vec{p}) \quad \quad E^{2} = m^{* 2} + p^{2} \\ 
	\frac{\partial H}{\partial q_{i}} = -\frac{dp_{i}}{dt} \quad \quad \frac{\partial H}{\partial p_{i}} =\frac{dq_{i}}{dt}
\end{gather}
	
\par Ahol tömeghéjon lévő kvázi-részecske közelítéssel élve az egyenlet átfogalmazható, felhasználva a Hamilton-egyenleteket:

\begin{equation} \label{BUU-eq:1}
	\frac{\partial f}{\partial t} + \frac{\partial f}{\partial \vec{p}}\Big(-\frac{m^{*}}{E}\nabla_{\vec{r}}U\Big) + \frac{\partial f}{\partial \vec{r}}\Big(\frac{\vec{p}}{E}+\frac{m^{*}}{E}\nabla_{\vec{p}}U\Big) = I_{coll}
\end{equation}

\par Az ütközési integrál ( $I_{coll}$ ) kvantumos jelenségek közül csak a Pauli-elvet veszi figyelembe, így jelentős részben klasszikus fizikán alapszik. Az így kapott egyenletet \eqref{BUU-eq:1} Boltzmann-Uehling-Uhlenbeck-egyenletnek nevezik.

\subsection{ Numerikus megoldás}

\par A témavezetőm szimulációs kódja a szokásos módszerrel áll neki ennek az integro-differenciál egyenlet megoldásának. A folytonos eloszlásfüggvény helyettesíthető véges számú pontrészecskékkel, matematikailag Dirac-delta disztribúciókkal. A fluktuációk simítása érdekében $N$ párhuzamos eseményt vizsgálva az eloszlás függvény $A$ nukleonra

\begin{equation}
	f(\vec{r}, \vec{p}, t) = \frac{1}{N}\sum_{i}^{N \times A} \delta(\vec{r} - \vec{r}_{i}(t))\delta(\vec{p} - \vec{p}_{i}(t))
\end{equation}

\par Ezt bevezetve látható, hogy a modell leegyszerűsödött pontrészecskék mozgására. A mozgásegyenletek a Hamilton-egyenletekből kaphatóak, amelyeket a \eqref{BUU-eq:1}-ben is felhasználtam.

\par A transzport-modell nem tartalmaz szabd paramétereket. A deriváltakat differenciálok váltják fel. Az egyrészecske mozgásegyenlet megoldásához a prediktor-korrektor módszer a következő

\begin{gather}
	\vec{p}^{pr}_{i} = \vec{p}_{i} - \Delta t \frac{\partial H}{\partial \vec{r}_{i}} \quad \quad \vec{r}^{pr}_{i} = \vec{r}_{i} + \Delta t \frac{\partial H}{\partial \vec{p}_{i}}
\end{gather}

\par Ahol $^{pr}$ jelöli a prediktált helyet és impulzust. Ez még korrekcióra szorul, ehhez ki kell számolni az predikdált helyen a Hamilton-függvény értékét, majd a helyet és momentumot annak megfelelően léptetni

\begin{gather}
	\vec{p}^{co}_{i} = \vec{p}_{i} - \frac{\Delta t}{2} \Big(\frac{\partial H}{\partial \vec{r}_{i}} + \frac{\partial H^{pr}}{\partial \vec{r}_{i}^{pr}} \Big) \quad \quad \vec{r}^{co}_{i} = \vec{r}_{i} + \frac{\Delta t}{2} \Big( \frac{\partial H}{\partial \vec{p}_{i}} + \frac{\partial H^{pr}}{\partial \vec{p}_{i}^{pr}} \Big)
\end{gather}

\par Az átlagtér potenciál szabadon választható az éppen megfelelő elméleti megfontolások alapján.

\section{ Koaleszcencia}

\par Az én feladatom a kimeneten szolgáltatott, térbeli és impulzustérbeli részecskeeloszlások alapján az volt, hogy egy olyan eljárást dolgozzak ki, amivel vizsgálható lesz a detektorválasz. Lévén, hogy nukleonokra koncentráltam, a kimenetek közül is egyenlőre ezeket vizsgáltam. A koaleszcencia modell lényege, hogy a nukleonok ha elegendően közel kerülnek egymáshoz impulzustérben, akkor bizonyos valószínűséggel összetapadnak és a detektorban már csak egy beütés észlelhető így, több összetapadt, töltéssel rendelkező részecske esetén.

\par A mechanizmust amely a nehézionütközések után kialakuló közepes méretű magokat leírja többen is megpróbáltak leírni. A koaleszcencia modell részletes leírása deuteron esetén megtalálható $J. I. Kapusta$ \footnote{Kapusta - Mechanism for deuteron production in relativistic nuclear collisions} cikkében. A szakirodalom a közepes magokkal foglalkozik (Z $\leq$ 15), ezeket az angol rövidítés alapján $IMF$-nek \footnote{intermediate fragments} nevezem majd. 

\par $Kapusta$ arról ír, hogy bármikor, amikor egy neutron és proton kellően közel kerül egymáshoz, azaz impulzusok egy $p_{0}$ gömbön belül van, valamint a megfelelő spinállapotban vannak, akkor összetepadnak. A spin- és izospinállapotokat figyelmen kívül hagyva, én is a minimális távolság alapján implementáltam a koaleszcenciát. A modell térben és impulzustérben is tud, külön-külön, a kettő együttesét a mérési adatokra megfelelően választott súlyfaktorokkal lehet implementálni.

\subsection{ Szélességi bejárás - Breadth First Traversal (BFS)}

\par A szélességi bejárás egy jól ismert gráf algoritmus az informatikában. Az algoritmus lényege, hogy egy gráfban adott tulajdonságú pontot keresve kiválogassa azt, biztosítva, hogy minden csúcsot leellenőrzött. Én nem egészen erre használom, mivel nekem klaszterezésre van szükségem, tehát nem adott tulajdonság alapján kell kiválogatnom csúcsokat, hanem egy nem összefüggő gráfot kellett darabjaira szétszednem.
\par Így az algoritmust kicsit módosítanom kellett. Hasznos tulajdonságai közé tartozik, hogy gyors, és biztosítja, hogy minden elemén egy gráfnak végigmegy. Így tehát addig kell ismételgetnem az algoritmust egy nem összefüggő gárfon míg annak vannak csúcsai összefüggő részgráfokban. 
\par Az algoritmus kiválaszt egy kezdőcsúcsot, majd a csúcsokat látogatottság szerint besorolja. Ezután egy szomszédsági lista szerint végigjárja az adott csúcs szomszédait. Lényegében ez a klaszterek megkeresésének módja. Hiszen miután kifogy a szomszédsági lista, kiválasztható random egy újabb csúcs, amin elindulva szintén megtalálhatóak annak szomszédai. 
\par A pszeudó-kódot mellékelem, hiszen az alapimplementáció C++, majd Fortran nyelveken valósul(t) meg.

\hfill

\pagebreak

\begin{center}
\begin{algorithm}
\caption{BFS klaszerező függvény}
\begin{algorithmic}
\STATE visitedVertices = vector($bool$)[FALSE]
\STATE startingVertex = 0
\WHILE{ allVerticesVisited(visitedVertices) }
	\STATE cluster = vector()
	\STATE visitedVertices[startingVertex] = TRUE
	\STATE queuedVertices = Queue()
	\STATE queuedVertices.Queue(startingVertex)
	\WHILE{ queueIsNotEmpty(queuedVertices) }
		\STATE currentVertex = queuedVertices.Front()
		\FORALL{ element of adjecencyList[currentVertex] }
			\IF{ isNotVisited(element) }
				\STATE visitedVertices[element] = TRUE
				\STATE queuedVertices.Queue(element)
			\ENDIF
		\ENDFOR
	\STATE saveCluster(cluster)
	\STATE startingVertex = findFirstNotVisited(visitedVertices)
	\ENDWHILE
\ENDWHILE
\end{algorithmic}
\end{algorithm}
\end{center}

\subsection{ Implementáció}

\par Mint ahogy az előző pontban említettem az algoritmushoz egy gráf szükséges. A szimuláció kimenetén a nehézion-ütközésekből nyert nukleonon hely- és impulzuseloszlását kapom meg. Mivel egy ütközés parallel $N$-szer lefut, egymás után pedig ez $M$-szer ismétlődik meg, így egy szimuláció során $N\cdot M$ kiértékelhető adatsort kapok, amikből már kellően nagy $N, M$ esetén már jó statisztikát lehet készíteni. Az eloszlások alapján térben és impulzustérben is szükségem van egy $r_{0}$ és egy $p_{0}$ klaszterező méretre. A bemeneti adataim $~fm~$ és $~GeV/c$~ nagyságrendűek. Egy klaszterdefiniálásánál kihasználom a négyesimpulzusmegmaradást, 

\begin{equation*}
	E = \sum_{i} E_{i} \quad \quad \vec{p} = \sum_{i} \vec{p}_{i}
\end{equation*} 

\par ahol az összegzés a klaszterekben lévő részecskékre megy. Itt nem veszem figyelembe, hogy kötési energia szabadul fel, csak egy közelítést szeretnék adni a majdani sebességre

\begin{equation*}
	p = \frac{v}{c} E \quad \quad E = \sqrt{M^{2} + p^{2}}
\end{equation*}

\par A $M$ tömeg tisztán a klaszterben lévő nukleonok tömege, ahol a proton tömegét $0.938 ~Gev/c$-nek, míg a neutron tömegét közelítőleg $0.939 ~Gev/c$-nek vettem. Az impulzus a fentebbi képlet alapján adott volt. Az irodalomban több helyen is elhanyagolják teljes mértékben a térbeli koaleszcenciát lévén, hogy relativisztikus részecskékről van szó, és az impulzustérbeli szomszédság. 

\par A programom beolvassa az $K$ számú adatfájlt, melyekből klasztereket csinál a $BFS$ algoritmus segítségével, valamint elvégzi a szükséges számításokat és ezek után egy fájlban a kidobja a klaszterméretet, energiát, sebességet, impulzuseloszlást és a kirepülő részecske polárszögét

\begin{equation*}
\varphi = \arccos\Big(\frac{p_{x}}{\sqrt{p_{x}^{2} + p_{y}^{2}}}\Big)
\end{equation*}

\section{ Mérési adatok}

\par A centrális arany-arany ütközéseket többek között a GSI-ben, Darmstadtban is vizsgáltak a FOPI kollaboráció keretében. A név egy $4\pi$ ('four pi') térszögű detektorra utal. Azaz ebben az elrendezésben a fragmentáció nagyon jól vizsgálható, hiszen minden irányben detektálni lehet a nehézion ütközések utána részecskéket. A FOPI-nál vizsgált nehézion nyalábot egy, a detektorban található céltárgyra bocsátották. Az általam használt szimulációban én be tudtam állítani, hogy az ütközésem centrális legyen, azonban a detektálás során ezeket az eseményket szűrni kellett, hiszen átlagosan $1\%$-át képviselték az összes ütközésnek.

\par Erre találták ki az $ERAT$ nevezetű mennyiséget. Ezt a következőképpen definiálták

\begin{equation*}
ERAT = \frac{E_{t}}{E_{l}} = \frac{\sum_{i} p_{t,i}^{2}/(m_{i} + E_{i})}{\sum_{i} p_{l,i}^{2}(m_{i} + E_{i})}
\end{equation*}

\par ahol $l,t$ indexek longitudinális és transzverzális energiákra és impulzusokra vonatkoznak. Az ütközés $z$-irányú, az összegzés a létrejött magokra megy. Az elv az, hogy feltétlezik, hogy transzverz energia túlnyomó többségében nukleon-nukleon kölcsönhatásból származik, és akkor maximális ha az ütközésben résztvevő magok a lehető legjobban átfednek, azaz ha centrális az ütközés.

\par Egy kizárólag termikus modell egy $T$ hőmérsékletű tágulás során tömegszám függvényében konstans energiát jósolnak, azonban, ha feltételezzük, hogy ütközés után egy izotróp robbanás megy végbe (az ősrobbanás analogonjára), akkor 

\begin{equation*}
<E_{kin}> = a + b\cdot A_{f}
\end{equation*}

\begin{figure}[!htb]
\centering
\includegraphics[width=0.45\textwidth]{./60fmcAuAu250AMeV007mom.png}
\caption{60 fm/c szimulációs idő, a vízszintes tengelyen a klaszterezett magok tömegszáma, míg a függőleges tengelyen a számolt mozgási energiájuk}
\end{figure}

\par Az előbbi ábrán látható, hogy csak [0;15] tömegszám intervallumban ábrázoltam a klaszterezett magokat, hiszen a FOPI mérés alapján ezek, az úgynevezett közepes magok (IMF) összehasonlíthatóak az én eredményeimmel is. 

\end{document}